
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/extraction/database/run_single_seismogram_db.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_extraction_database_run_single_seismogram_db.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_extraction_database_run_single_seismogram_db.py:


Single Seismogram
=================

The tutorial will go over the reading of a three component seismogram from a
station file in the database by loading one that is included in the Github repo.
At the end, we plot the seismograms using built-in plotting tools.

Loading all modules
-------------------

.. GENERATED FROM PYTHON SOURCE LINES 14-15

.. code-block:: default









.. GENERATED FROM PYTHON SOURCE LINES 18-30

.. code-block:: default


    # External
    import matplotlib.pyplot as plt
    from obspy import read, read_inventory, Stream

    # Internal
    from gf3d.source import CMTSOLUTION
    from gf3d.seismograms import GFManager, get_seismograms
    from gf3d.process import process_stream
    from gf3d.plot.seismogram import plotseismogram









.. GENERATED FROM PYTHON SOURCE LINES 31-32

Getting a CMTSOLUTION and load data

.. GENERATED FROM PYTHON SOURCE LINES 32-40

.. code-block:: default


    # CMTSOLUTION
    cmt = CMTSOLUTION.read('../../DATA/single_element_read/CMTSOLUTION')
    print(cmt)

    raw = read("../../DATA/single_element_read/traces/*.sac")
    inv = read_inventory("../../DATA/single_element_read/station.xml")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

     PDE 2015  9 16 22 54 32.90 -31.5700  -71.6700  22.4 0.0 8.3 NEAR COAST OF CENTRAL CH
    event name:  201509162254A
    time shift:     49.9800
    half duration:  33.4000
    latitude:      -31.1300
    longitude:     -72.0900
    depth:          17.3500
    Mrr:       1.950000e+28
    Mtt:      -4.360000e+26
    Mpp:      -1.910000e+28
    Mrt:       7.420000e+27
    Mrp:      -2.480000e+28
    Mtp:       9.420000e+26





.. GENERATED FROM PYTHON SOURCE LINES 41-44

Note that the data has been downloaded from IRIS previously, but it has not
been processed. Now, we can query the database for synthetic seismograms
corresponding to the observed ones.

.. GENERATED FROM PYTHON SOURCE LINES 46-47

Loading a single station file from the database

.. GENERATED FROM PYTHON SOURCE LINES 47-61

.. code-block:: default


    # Load subset
    filename = '../../DATA/single_element_read/DB/II/BFO/II.BFO.h5'

    gfm = GFManager([filename])
    gfm.load_header_variables()

    # You will have to load a subset of elements first (just one here for storage reasons)
    gfm.get_elements(cmt.latitude, cmt.longitude, cmt.depth, 100, NGLL=5)

    # Finally you can read the seismograms.
    rp = gfm.get_seismograms(cmt)






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    0: <HDF5 file "II.BFO.h5" (mode r)>




.. GENERATED FROM PYTHON SOURCE LINES 62-64

Then, we select the station in question and process both observed and
synthetics seismograms for a band-pass of [40-300].

.. GENERATED FROM PYTHON SOURCE LINES 64-73

.. code-block:: default


    network = 'II'
    station = 'BFO'
    obs = process_stream(
        raw.select(network=network, station=station), inv=inv, cmt=cmt, duration=3300)
    syn = process_stream(
        rp.select(network=network, station=station), cmt=cmt, duration=3300)









.. GENERATED FROM PYTHON SOURCE LINES 74-75

Set plot limits and plot seismogram

.. GENERATED FROM PYTHON SOURCE LINES 75-87

.. code-block:: default


    starttimeoffset = 0.0
    endtimeoffset = 0.0
    duration = 3600
    limits = \
        obs[0].stats.starttime + starttimeoffset, \
        obs[0].stats.starttime + starttimeoffset + duration + endtimeoffset

    plotseismogram(obs, syn, cmt, limits=limits, nooffset=True, lw=0.25)

    plt.show()




.. image-sg:: /examples/extraction/database/images/sphx_glr_run_single_seismogram_db_001.svg
   :alt: run single seismogram db
   :srcset: /examples/extraction/database/images/sphx_glr_run_single_seismogram_db_001.svg
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 88-89

The seismograms are offset for clarity so that they are easy to read.s


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.426 seconds)


.. _sphx_glr_download_examples_extraction_database_run_single_seismogram_db.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: run_single_seismogram_db.py <run_single_seismogram_db.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: run_single_seismogram_db.ipynb <run_single_seismogram_db.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
