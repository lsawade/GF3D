
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/extraction/subset/single_seismogram.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_extraction_subset_single_seismogram.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_extraction_subset_single_seismogram.py:


Single Seismogram
=================

The tutorial will go over the reading of a subset file by loading one that is
included in the directory. At the end we plot an aligned section of waveforms
using built-in plotting tools.

Loading all modules
-------------------

.. GENERATED FROM PYTHON SOURCE LINES 14-26

.. code-block:: default



    # External
    import matplotlib.pyplot as plt
    from obspy import read, read_inventory

    # Internal
    from gf3d.source import CMTSOLUTION
    from gf3d.seismograms import GFManager
    from gf3d.process import process_stream
    from gf3d.plot.seismogram import plotseismogram








.. GENERATED FROM PYTHON SOURCE LINES 29-30

Getting a CMTSOLUTION

.. GENERATED FROM PYTHON SOURCE LINES 30-35

.. code-block:: default


    # CMTSOLUTION
    cmt = CMTSOLUTION.read('../../DATA/single_element_read/CMTSOLUTION')
    print(cmt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

     PDE 2015  9 16 22 54 32.90 -31.5700  -71.6700  22.4 0.0 8.3 NEAR COAST OF CENTRAL CH
    event name:  201509162254A
    time shift:     49.9800
    half duration:  33.4000
    latitude:      -31.1300
    longitude:     -72.0900
    depth:          17.3500
    Mrr:       1.950000e+28
    Mtt:      -4.360000e+26
    Mpp:      -1.910000e+28
    Mrt:       7.420000e+27
    Mrp:      -2.480000e+28
    Mtp:       9.420000e+26





.. GENERATED FROM PYTHON SOURCE LINES 36-37

Loading the subset database

.. GENERATED FROM PYTHON SOURCE LINES 37-41

.. code-block:: default


    gfsub = GFManager("../../DATA/single_element_read/single_element.h5")
    gfsub.load()








.. GENERATED FROM PYTHON SOURCE LINES 42-43

Load Observed Data and response files

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default

    raw = read("../../DATA/single_element_read/traces/*.sac")
    inv = read_inventory("../../DATA/single_element_read/station.xml")








.. GENERATED FROM PYTHON SOURCE LINES 47-50

Note that the data has been downloaded from IRIS previously, but it has not
been processed. Now, we can query the database for synthetic seismograms
corresponding to the observed ones.

.. GENERATED FROM PYTHON SOURCE LINES 52-56

.. code-block:: default


    rp = gfsub.get_seismograms(cmt)









.. GENERATED FROM PYTHON SOURCE LINES 57-59

Then, we select the station in question and process both observed and
synthetics seismograms for a band-pass of [40-300].

.. GENERATED FROM PYTHON SOURCE LINES 59-67

.. code-block:: default


    network = 'II'
    station = 'BFO'
    obs = process_stream(
        raw.select(network=network, station=station), inv=inv, cmt=cmt, duration=3600)
    syn = process_stream(
        rp.select(network=network, station=station), cmt=cmt, duration=3600)








.. GENERATED FROM PYTHON SOURCE LINES 68-69

Set plot limits and plot seismogram

.. GENERATED FROM PYTHON SOURCE LINES 69-79

.. code-block:: default


    starttimeoffset = 500.0
    endtimeoffset = 0.0
    duration = 1000.0
    limits = \
        syn[0].stats.starttime + starttimeoffset, \
        syn[0].stats.starttime + starttimeoffset + duration + endtimeoffset

    plotseismogram(obs, syn, cmt, limits=limits)
    plt.show()



.. image-sg:: /examples/extraction/subset/images/sphx_glr_single_seismogram_001.svg
   :alt: single seismogram
   :srcset: /examples/extraction/subset/images/sphx_glr_single_seismogram_001.svg
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.462 seconds)


.. _sphx_glr_download_examples_extraction_subset_single_seismogram.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: single_seismogram.py <single_seismogram.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: single_seismogram.ipynb <single_seismogram.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
